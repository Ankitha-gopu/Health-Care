{% extends 'base.html' %}
{% block title %}Chat with Doctor's Assistant{% endblock %}

{% block content %}
<div class="container py-4 h-100">
    <div class="row h-100 justify-content-center">
        <div class="col-md-10 col-lg-8 d-flex flex-column" style="max-height: 85vh;">
            <div class="card border-0 shadow-lg flex-grow-1 d-flex flex-column"
                style="border-radius: 20px; overflow: hidden; background: #f0f2f5;">
                <!-- Header -->
                <div class="bg-primary text-white p-3 d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center">
                        <img src="https://i.pravatar.cc/100?img=5" class="rounded-circle border me-2"
                            style="width: 40px; height: 40px;" alt="Assistant">
                        <div>
                            <h6 class="mb-0 fw-bold">Doctor's Assistant</h6>
                            <span class="small opacity-75">Online</span>
                        </div>
                    </div>
                    <a href="#" class="text-white text-decoration-none small fw-bold">Help?</a>
                </div>

                <!-- Chat Body -->
                <div class="chat-body p-4 flex-grow-1 overflow-auto" id="chatContainer">
                    <!-- Bot Message 1 -->
                    <div class="d-flex mb-4">
                        <div class="bg-white p-3 shadow-sm" style="border-radius: 0 20px 20px 20px; max-width: 80%;">
                            <p class="mb-0 Small">Hello <strong>{{ user.first_name }}</strong>! Welcome to MediPlus. I
                                am the Doctor's Assistant. I've noted down your consultation details for
                                <strong>specialist</strong>.</p>
                            <p class="mb-0 small mt-2 opacity-75">1 min ago</p>
                        </div>
                    </div>

                    <!-- Bot Message 2 with Question -->
                    <div class="d-flex mb-4">
                        <div class="bg-white p-3 shadow-sm" style="border-radius: 0 20px 20px 20px; max-width: 85%;">
                            <h6 class="fw-bold small mb-3">Are you experiencing any of the following?</h6>
                            <form id="triageForm" method="GET"
                                action="{% url 'consultation_date_time' speciality.id %}">
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="symptom_check" id="s1"
                                        value="fever" required>
                                    <label class="form-check-label small" for="s1">Dry cough for past 2 days</label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="symptom_check" id="s2"
                                        value="breathing">
                                    <label class="form-check-label small" for="s2">Loss of hair or skin rash</label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="symptom_check" id="s3"
                                        value="body">
                                    <label class="form-check-label small" for="s3">Change in appetite or weight</label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="radio" name="symptom_check" id="s4"
                                        value="none">
                                    <label class="form-check-label small" for="s4">None of the above / already
                                        stated</label>
                                </div>
                                <button type="submit"
                                    class="btn btn-primary btn-sm w-100 rounded-pill py-2">Submit</button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Footer / Input (Disabled for Assistant Flow) -->
                <div class="bg-white p-3 border-top d-flex gap-2 align-items-center">
                    <input type="text" class="form-control rounded-pill border-0 bg-light p-2"
                        placeholder="Type a message..." disabled>
                    <button class="btn btn-primary rounded-circle" style="width: 40px; height: 40px;"><i
                            class="bi bi-send-fill"></i></button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .chat-body {
        background: #e5ddd5 url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png') repeat;
    }

    #chatContainer::-webkit-scrollbar {
        width: 5px;
    }

    #chatContainer::-webkit-scrollbar-thumb {
        background: rgba(0, 0, 0, 0.1);
        border-radius: 10px;
    }
</style>

<script>
    // Auto scroll to bottom
    const chat = document.getElementById('chatContainer');
    chat.scrollTop = chat.scrollHeight;
</script>
{% endblock %}